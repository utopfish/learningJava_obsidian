## 8.1 定义
考虑这样一种物品，它并没有固定的费用和价值，而是它的价值随着你分
配给它的费用而变化。这就是泛化物品的概念。

更严格的定义之。在背包容量为 $V$ 的背包问题中，泛化物品是一个定义域为$0 . . . V$中的整数的函数h，当分配给它的费用为 $v$ 时，能得到的价值就是 $h(v)$。

这个定义有一点点抽象，另一种理解是一个泛化物品就是一个数组 $h[0 . . . V ]$，给它费用 $v$，可得到价值 $h[v]$。

一个费用为 $c$ 价值为 $w$ 的物品，如果它是01背包中的物品，那么把它看成泛化物品，它就是除了 $h(c) = w$ 外，其它函数值都为 0 的一个函数。如果它是完全背包中的物品，那么它可以看成这样一个函数，仅当 $v$ 被 $c$ 整除时有$h(v) =w ·\frac{v}{c}$，其它函数值均为 0。如果它是多重背包中重复次数最多为 $m$ 的物品，那么它对应的泛化物品的函数有$h(v) = w ·\frac{v}{c}$仅当 $v$ 被 $c$ 整除且 $\frac{v}{c} ≤ n$，其它情况函数值均为0。

一个物品组可以看作一个泛化物品 $h$。对于一个 $0 . . . V$ 中的 $v$，若物品组中不存在费用为 $v$ 的物品，则h(v) = 0，否则h(v)取值为所有费用为 $v$ 的物品的最大价值。[[分组的背包问题]]中每个主件及其附件集合等价于一个物品组，自然也可看作一个泛化物品。

## 8.2 泛化物品的和
如果给定了两个泛化物品 $h$ 和 $l$，要用一定的费用从这两个泛化物品中得到最大的价值，这个问题怎么求呢？事实上，对于一个给定的费用 $v$，只需枚举将这个费用如何分配给两个泛化物品就可以了。同样的，对于$0. . .V$ 中的每一个整数 $v$，可以求得费用 $v$ 分配到 $h$ 和 $l$ 中的最大价值 $f(v)$。也即
$f(v) = max{h(k) + l(v − k) | 0 ≤ k ≤ v}$

可以看到，这里的 $f$ 是一个由泛化物品h和l决定的定义域为 $0. . .V$ 的函数，也就是说，$f$ 是一个由泛化物品 $h$ 和 $l$ 决定的泛化物品。

我们将 $f$ 定义为泛化物品 $h$ 和 $l$ 的和：$h、l$ 都是泛化物品，若函数 $f$ 满足以上关系式，则称 $f$ 是 $h$ 与 $l$ 的和。泛化物品和运算的时间复杂度取决于背包的容量，是$O(V^2)$。

由泛化物品的定义可知：在一个背包问题中，若将两个泛化物品代以它们的和，不影响问题的答案。事实上，对于其中的物品都是泛化物品的背包问题，求它的答案的过程也就是求所有这些泛化物品之和的过程。若问题的和为 $s$，则答案就是 $s(0 . . . V )$ 中的最大值。
## 8.3 背包问题的泛化物品
一个背包问题中，可能会给出很多条件，包括每种物品的费用、价值等属性，物品之间的分组、依赖等关系等。但肯定能将问题对应于某个泛化物品。也就是说，给定了所有条件以后，就可以对每个非负整数 $v$ 求得：若背包容量为 $v$，将物品装入背包可得到的最大价值是多少，这可以认为是定义在非负整数集上的一件泛化物品。这个泛化物品——或者说问题所对应的一个定义域为非负整数的函数——包含了关于问题本身的高度浓缩的信息。一般而言，求得这个泛化物品的一个子定义域（例如$0. . .V$ ）的值之后，就可以根据这个函数的取值得到背包问题的最终答案。

综上所述，一般而言，求解背包问题，即求解这个问题所对应的一个函数，即该问题的泛化物品。而求解某个泛化物品的一种常用方法就是将它表示为若干泛化物品的和然后求之。

## 8.4 小结
本讲是我在学习函数式编程的Scheme语言时，用函数编程的眼光审视各类背包问题得出的理论。
我想说：“思考”是一个程序员最重要的品质。简单的问题，深入思考以后，也能发现更多。