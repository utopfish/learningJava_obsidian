zset底层的存储结构包括**ziplist或skiplist**，在同时满足以下两个条件的时候使用ziplist，其他时候使用skiplist，两个条件如下：

1. 有序集合保存的元素数量小于128个
2. 有序集合保存的所有元素的长度小于64字节

 当ziplist作为zset的底层存储结构时候，每个集合元素使用两个紧挨在一起的压缩列表节点来保存，第一个节点保存元素的成员，第二个元素保存元素的分值。

 当skiplist作为zset的底层存储结构的时候，使用skiplist按序保存元素及分值，使用dict来保存元素和分值的映射关系。

## ziplist数据结构

当ziplist作为zset的底层存储结构时候，每个集合元素使用两个紧挨在一起的压缩列表节点来保存，第一个节点保存元素的成员，第二个元素保存元素的分值
![[ziplist数据结构.bmp]]

## skiplist数据结构

skiplist作为zset的存储结构，整体存储结构如下图，核心点主要是包括一个dict对象和一个skiplist对象。dict保存key/value，key为元素，value为分值；skiplist保存的有序的元素列表，每个元素包括元素和分值。两种数据结构下的元素指向相同的位置。
![[skiplist数据结构.bmp]]

#### 跳表

![[跳表数据结构.bmp]]
可以看到我们通过分等级，从最高等级向低等级查询，效率提高，其时间复杂度为logn（类似于二分查找）
